<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link href="https://www.contentstack.com/sdks/contentstack-ui-extensions/dist/1.1.0/ui-extension-sdk.min.css" rel="stylesheet" type="text/css" media="all">
  <style media="all">
.field-label{color:#4f6471;font-size:15px!important}.form-control{color:#748590;height:35px!important;max-width:255px!important}.container{padding-top:15px}.thumbnail{width:100%;height:100%}.select2-results__option{width:20%;float:left}img.img-thumbnail{max-height:126px}#run-btn{width:103px;margin-top:5px;margin-bottom:20px}#run-btn img{vertical-align:sub;margin-right:10px}#run-btn[disabled]{width:160px}.cs-form-group{margin-bottom:35px}label{font-weight:400;font-size:14px;color:#4F6470}.badge-info{background:#F0F9FE;border-radius:3px;font-size:14px;color:#6C7982;border:1px solid #C9DDE2;white-space:normal}.count-value,.keys{font-size:14px;color:#748490}.keys{width:34%;margin-bottom:10px;display:inline-block}.list-group-item{background-color:#fff;border:none;padding-left:0}.result-li{border-bottom:1px solid rgba(0,0,0,.125)}#result-container{max-height:360px;overflow:auto;padding-bottom:25px}body{max-height:600px;overflow:auto}.result-wrapper{border-bottom:2px solid rgba(0,0,0,.125)}#result-container::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}#result-container::-webkit-scrollbar{width:5px;background-color:transparent}#result-container::-webkit-scrollbar-thumb{border-radius:6px;background-color:#dfe2e9;cursor:pointer}.alert-danger{display:block;font-size:12px;color:#F77D7A;text-align:left;padding-top:0;padding-left:0;margin-top:-10px;background-color:transparent;border:0}
</style>
  <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  <script src="https://www.contentstack.com/sdks/contentstack-ui-extensions/dist/1.1.0/ui-extension-sdk.js"></script>
</head>
<body>
  <div class="container">
    <div class="cs-form-group">
      <label for="models" class="field-label">Select Model</label>
      <select class="form-control" id="models"></select>
    </div>
    <div class="cs-form-group">
      <label for="field" class="field-label">Field</label>
      <select class="form-control" id="field"></select>
    </div>
    <button type="submit" id="run-btn" class="btn cs-btn-primary"><img src="https://images.contentstack.io/v3/assets/bltc249966903dc3407/blt40a60d26b3d8095f/5b7660b25b9f14da0eb07a34/operation.svg" alt="run-icon">Run</button>
  </div>
  <div class="container" id="result-container">
    <ul class="list-group" id="result-list">
    </ul>
  </div>
  <script>
"use strict";var _models;function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var models=(_defineProperty(_models={retail_classifer:{name:"Retail Classifier",path:"/v3/classifiers/cl_mmYLCZUN/classify/",type:"classifications"},business_classifier:{name:"Business Classifier",path:"/v3/classifiers/cl_5vWJMjGc/classify/",type:"classifications"},profanity_and_abuse_detection:{name:"Profanity & Abuse Detection",path:"/v3/classifiers/cl_KFXhoTdt/classify/",type:"classifications"},language_classifier:{name:"Language Classifier",path:"/v3/classifiers/cl_v2GCwYhf/classify/",type:"classifications"},news_classifier:{name:"News Classifier",path:"/v3/classifiers/cl_WDyr2Q4F/classify/",type:"classifications"},sentiment_analysis:{name:"Sentiment Analysis",path:"/v3/classifiers/cl_Jx8qzYJh/classify/",type:"classifications"}},"sentiment_analysis",{name:"Sentiment Analysis",path:"/v3/classifiers/cl_Jx8qzYJh/classify/",type:"classifications"}),_defineProperty(_models,"product_sentiment",{name:"Product Sentiment",path:"/v3/classifiers/cl_TWmMTdgQ/classify/",type:"classifications"}),_defineProperty(_models,"nps_saas_topic",{name:"NPS SaaS Feedback Classifier",path:"/v3/classifiers/cl_gYDZjEnS/classify/",type:"classifications"}),_defineProperty(_models,"outbound_sales_classifier",{name:"Outbound Sales Classifier",path:"/v3/classifiers/cl_zSDSt8QP/classify/",type:"classifications"}),_defineProperty(_models,"commerce_cs_classifier",{name:"E-Commerce Customer Support Classifier",path:"/v3/classifiers/cl_GhPhiVYE/classify/",type:"classifications"}),_defineProperty(_models,"keyword_extraction",{name:"Keyword Extraction",path:"/v3/extractors/ex_y7BPYzNG/extract/",type:"extractions"}),_defineProperty(_models,"summarizer",{name:"Summarizer",path:"/v3/extractors/ex_94WD2XxD/extract/",type:"extractions"}),_defineProperty(_models,"insight_extraction",{name:"Insight Extraction",path:"/v3/extractors/ex_EjosnyKK/extract/",type:"extractions"}),_defineProperty(_models,"person_extraction",{name:"Person Extraction",path:"/v3/extractors/ex_SmwSdZ3C/extract/",type:"extractions"}),_defineProperty(_models,"location_extraction",{name:"Location Extraction",path:"/v3/extractors/ex_vqBQ7V9B/extract/",type:"extractions"}),_defineProperty(_models,"company_extraction",{name:"Company Extraction",path:"/v3/extractors/ex_A9nCcXfn/extract/",type:"extractions"}),_defineProperty(_models,"date_time_extraction",{name:"Date Time Extraction",path:"/v3/extractors/ex_LPxHGwJT/extract/",type:"extractions"}),_defineProperty(_models,"price_extraction",{name:"Price Extraction",path:"/v3/extractors/ex_wNDME4vE/extract/",type:"extractions"}),_defineProperty(_models,"url_extraction",{name:"URL Extraction",path:"/v3/extractors/ex_owGiMc4z/extract/",type:"extractions"}),_defineProperty(_models,"email_extraction",{name:"Email Address Extraction",path:"/v3/extractors/ex_YWBmKCP9/extract/",type:"extractions"}),_defineProperty(_models,"email_cleaner",{name:"Email Cleaner",path:"/v3/extractors/ex_BXqiifAi/extract/",type:"extractions"}),_defineProperty(_models,"phone_number_extraction",{name:"Phone Number Extraction",path:"/v3/extractors/ex_ktEPNd9V/extract/",type:"extractions"}),_models),fieldPaths=[];function renderModelSelectField(){$.each(models,function(e,t){$("#models").append($("<option></option>").attr("value",e).text(t.name))})}function renderFieldSelectField(e){var a=$("#field").val();$("#field").empty(),(fieldPaths=getPaths(e.entry.content_type,e.entry.getData())).forEach(function(e){var t=$("<option></option>").attr("value",e.uid).text(e.titlePaths.join(" > "));a===e.uid&&t.attr("selected","selected"),$("#field").append(t)})}function getPaths(e,t){var s=[];return function l(e,a,t,d){var p=4<arguments.length&&void 0!==arguments[4]?arguments[4]:[],n=t?t.split("."):[];e.forEach(function(r,e){var o=[].concat(_toConsumableArray(n),[r.uid]),c=o.join(".");if(a&&void 0!==a[r.uid]){if("text"===r.data_type)if(!1===r.multiple){var t=d||c;s.push({uid:c,path:o,value:a[r.uid],setuid:t,titlePaths:[].concat(_toConsumableArray(p),[r.display_name])})}else 0<a[r.uid].length&&a[r.uid].forEach(function(e,t){var a=[].concat(_toConsumableArray(o),[t]),n=(a.join("."),d||c);s.push({uid:a.join("."),path:a,value:e,setuid:n,titlePaths:[].concat(_toConsumableArray(p),[r.display_name,t])})});"group"===r.data_type&&(!1===r.multiple?l(r.schema,a[r.uid],c,d,[].concat(_toConsumableArray(p),[r.display_name])):0<a[r.uid].length&&a[r.uid].forEach(function(e,t){var a=[].concat(_toConsumableArray(o),[t]);l(r.schema,e,a.join("."),d,[].concat(_toConsumableArray(p),[r.display_name,t]))})),"blocks"===r.data_type&&0<a[r.uid].length&&a[r.uid].forEach(function(e,t){var a=[].concat(_toConsumableArray(o),[t]),n=Object.keys(e)[0],s=r.blocks.find(function(e){return e.uid===n}).schema,i=e[n];d=c,l(s,i,a.join("."),d,[].concat(_toConsumableArray(p),[r.display_name,t]))})}})}(e.schema,t),s}function domChangeListner(e){e.entry.onSave(function(){return renderFieldSelectField(e)}),$("#run-btn").on("click",function(){var t=$("#models").val();$("#run-btn").prop("disabled",!0),$("#run-btn").html("Working on it..."),$("#result-container").html(""),runAnalysis(t,fieldPaths.find(function(e){return e.uid===$("#field").val()}).value,e.config.token).then(function(e){$("#run-btn").prop("disabled",!1),$("#run-btn").html(""),$("#run-btn").append('<img src="https://images.contentstack.io/v3/assets/bltc249966903dc3407/blt40a60d26b3d8095f/5b7660b25b9f14da0eb07a34/operation.svg" alt="run-icon"/> Run'),renderResult(e,models[t])}).catch(function(e){console.log(e),$("#run-btn").prop("disabled",!1),$("#run-btn").html(""),$("#run-btn").append('<img src="https://images.contentstack.io/v3/assets/bltc249966903dc3407/blt40a60d26b3d8095f/5b7660b25b9f14da0eb07a34/operation.svg" alt="run-icon"/> Run'),$("#result-container").append('<div class="alert alert-danger" role="alert">'+e.message+"</div>")})})}function runAnalysis(n,e,s){var i=void 0;return new Promise(function(t,a){fetch("https://api.monkeylearn.com"+models[n].path,{method:"POST",body:JSON.stringify({data:[e]}),headers:{Authorization:"Token "+s,"Content-Type":"application/json"}}).then(function(e){return e.headers.get("X-Query-Limit-Remaining")&&$("#result-container").append("<label>Result:</label>"),i=e.status,e.json()}).then(function(e){throw 200===i&&t(e[0]),Error("Failed to run "+models[n].name+": "+e.detail)}).catch(function(e){a(e)})})}function renderResult(e,t){if($("#result-container").append('<ul class="list-group" id="result-list"></ul>'),e&&0!==e[t.type].length||$("#result-list").append('<li class="list-group-item result-li">No Results</li>'),"classifications"===t.type)return e[t.type].forEach(function(e,t){var a="<li class='list-group-item'><div><span class='keys'>Tag : </span><span class='badge badge-info'>"+e.tag_name+"</span> </br> <span class='keys'> Confidence:</span> <span class='count-value'>"+(100*e.confidence).toFixed(2)+"% </span></div></li>";$("#result-list").append(a)});"extractions"===t.type&&e[t.type].forEach(function(e,t){var a="<li class='list-group-item'><div class='result-wrapper'><span class='keys'>"+e.tag_name+" :</span> <span class='badge badge-info'>";a+=e.parsed_value+"</span> ",e.relevance&&(a+="</br><span class='keys'> Relevance :</span>"+(100*e.relevance).toFixed(2)+"%</span> "),e.count&&(a+="</br><span class='keys'> Count :</span>"+e.count+"</span> "),a+="</div></li>",$("#result-list").append(a)})}$(document).ready(function(){ContentstackUIExtension.init().then(function(e){e.window.enableAutoResizing(),renderModelSelectField(),renderFieldSelectField(e),domChangeListner(e)})});
</script>
</body>
</html>